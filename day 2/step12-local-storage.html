<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Storage step2</title>
    <script>
        window.onload = function(){
            getUserName();
        };
        function addUserInfo(){
            var count = localStorage.length;
            var userobj = {
                firstname : document.getElementById("fn").value,
                lastname : document.getElementById("ln").value,
                power : document.getElementById("power").value
            };
            localStorage.setItem(document.getElementById("title").value, JSON.stringify(userobj) );
            getUserName();
            document.getElementById("fn").value = "";
            document.getElementById("ln").value = "";
            document.getElementById("power").value = "";
            document.getElementById("title").value = "";
        }
        function getCount(){
            alert(localStorage.length);
        }
        function getUserName(){
           var count = localStorage.length;
           var log = document.getElementById("log");
           log.innerHTML = "";
           for(var i = 0; i < count; i++){
            
            var keyname = localStorage.key(i);
            var currentHero = JSON.parse(localStorage.getItem(keyname))
            log.innerHTML+="<p>"+keyname+" : "+currentHero.firstname+" "+currentHero.lastname+" power is +"+currentHero.power+"</p>";
            console.log(currentHero.firstname+" "+currentHero.lastname);
           }
        };
        function removeFirstName(){
            var count = localStorage.length;
            var item = document.getElementById("txtkey").value;
            for(var i = 0; i < count; i++){
            // var currentHero = JSON.parse(localStorage.getItem(localStorage.key(i)))
            // var currentHero = JSON.parse(localStorage.getItem(item))
            var currentHero = localStorage.key(i);
               if(currentHero === document.getElementById("txtkey").value){
                localStorage.removeItem(item);
                getUserName();
               }
            }
        }
        function allClear(){
            localStorage.clear();
            alert("all cleared");
        }
        function getKey(){
            alert(localStorage.key(0));
        }
    </script>
</head>
<body>
    <fieldset>
        <legend>User Login Form</legend>
        <table>
            <thead>
                <tr>
                    <th>Title</th>
                    <th>First Name</th>
                    <th>Last Name</th> 
                    <th>Power</th> 
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <input id="title" type="text">
                    </td>
                    <td>
                        <input id="fn" type="text">
                    </td>
                    <td>
                       <input id="ln" type="text">
                    </td>
                    <td>
                        <input id="power" type="range" min="0" max="10">
                        <!-- <input id="power" type="text"> -->
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <button onclick="addUserInfo()">Add User Info</button>
                    </td>
                </tr>
            </tbody>
        </table>
        <hr>
        <div id="log"></div>
        <hr>
        <label>Remove from list</label>
        <input id="txtkey" type="text"/>
        <button onclick="removeFirstName()">Remove</button>
    </fieldset>
   <!--  <button onclick="clickHandler()">Set User Name</button>
    <button onclick="getHandler()">Get User Name</button> -->
    <!-- <button onclick="getCount()">Number of items stored</button> -->
    <br>
    <button onclick="getUserName()">Get All Avengers</button>
    <!-- <br> -->
    <!-- <button onclick="removeFirstName()">Remove First Name</button>
    <br>
    <button onclick="allClear()">All Clear </button>
    <br>
    <button onclick="getKey()">Get First Key</button> -->
</body>
</html>